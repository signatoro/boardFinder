#:include kv/cards/userCard.kv


<GameGroupScreen>:
    name: 'game_group_screen'

    # container for whole screen
    MDBoxLayout:
        orientation: "vertical"

        # top bar
        TopBar:
            id: topBar

        # to create scrolling effect
        MDScrollView:
            size_hint: (1, 1)
            do_scroll_y: True
            do_scroll_x: False

            # Container for whole scrolling container
            MDBoxLayout:
                id: game_group_screen_container
                orientation: "vertical"
                size_hint_y: None
                size_hint_x: 1
                adaptive_height: True
                padding: [dp(10), dp(15), dp(10), dp(15)]
                spacing: dp(10)

                MDBoxLayout:
                    orientation: "vertical"
                    size_hint_y: None
                    padding: [0, dp(5), 0, 0]

                    AnchorLayout:
                        anchor_x: 'left'
                        anchor_y: 'top'
                        padding: [dp(5), 0, 0, dp(30)]

                        MDFillRoundFlatIconButton:
                            text: "Back"
                            on_release: root.go_to_page_before()

                # group image
                FitImage:
                    id: game_group_image
                    md_bg_color: (0.76, 0.74, 0.78, 1)
                    allow_stretch: True
                    keep_ratio: True
                    source: root.group_image
                    size_hint: None, None
                    size: dp(400), dp(300)
                    halign: "center"
                    pos_hint: {"center_x": 0.5}

                # group title
                MDLabel:
                    id: game_group_title
                    text: root.group_title
                    font_style: "H2"
                    text_color: "teal"
                    md_bg_color: (0.76, 0.74, 0.78, 1)
                    size_hint_y: None
                    halign: "center"
                    height: self.texture_size[1]  # Adjust the size based on text size

                # group description label:
                MDLabel:
                    id: gen_description_label
                    text: "Description"
                    font_style: "H6"
                    text_color: (0, 0, 0, 0) # black
                    size_hint_y: None
                    halign: "left"
                    height: self.texture_size[1]  # Adjust the size based on text size

                # group general description
                MDLabel:
                    id: game_group_gen_description
                    text: root.group_general_description
                    text_color: (0, 0, 0, 1) # black
                    #font_style: "H5"
                    size_hint_y: None
                    halign: "center"
                    height: self.texture_size[1]  # Adjust the size based on text size

                SeparatorLine:
                    size_hint: 1, None
                    size: dp(3), dp(3)

                # group additional description
                MDLabel:
                    id: game_group_additional_description
                    text: root.group_additional_description
                    #font_style: "normal"
                    text_color: (0, 0, 0, 1) # black
                    size_hint_y: None
                    halign: "center"
                    height: self.texture_size[1]  # Adjust the size based on text size

                # Tags section
                MDStackLayout:
                    id: group_tags_list
                    orientation: 'lr-tb'
                    spacing: dp(10)
                    adaptive_height: True

                # host info
                MDBoxLayout:
                    id: game_group_host_info_container
                    orientation: "vertical"
                    padding: [20, 0, 20, 50]
                    size_hint: 1, None
                    adaptive_height: True
                    radius: 25
                    md_bg_color: app.theme_cls.primary_color

                    # host info header
                    MDLabel:
                        id: game_group_host_info_header
                        radius: 25
                        text: "Host Info"
                        font_style: "H4"
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1  # White text color
                        md_bg_color: app.theme_cls.primary_color  # Use the primary color as the outline color
                        size_hint_y: None
                        halign: "center"
                        height: self.texture_size[1]  # Adjust the size based on text size

                    # host info content
                    MDBoxLayout:
                        orientation: "vertical"
                        spacing: dp(5)
                        size_hint_y: None
                        adaptive_height: True

                        # host name
                        MDLabel:
                            id: game_group_host_name
                            text: f"Name: {root.group_host_fname} {root.group_host_lname}"
                            color: [.2, .2, .2, 1]
                            font_size: 24
                            size_hint_x: 1
                            size_hint_y: None
                            halign: "left"
                            height: self.texture_size[1]

                        # host email
                        MDLabel:
                            id: game_group_host_email
                            text: f"Email: {root.group_host_email}"
                            color: [.2, .2, .2, 1]
                            font_size: 24
                            size_hint_x: 1
                            size_hint_y: None
                            halign: "left"
                            height: self.texture_size[1]

                        # host phone number
                        MDLabel:
                            id: game_group_host_phone_num
                            text: f"Phone #: {root.group_host_phone_num}"
                            color: [.2, .2, .2, 1]
                            font_size: 24
                            size_hint_x: 1
                            size_hint_y: None
                            halign: "left"
                            height: self.texture_size[1]

                # meet info
                MDBoxLayout:
                    id: game_group_meet_info_container
                    orientation: "vertical"
                    padding: [20, 0, 20, 50]
                    size_hint: 1, None
                    adaptive_height: True
                    radius: 25
                    md_bg_color: app.theme_cls.primary_color

                    # meet info header
                    MDLabel:
                        id: game_group_meet_info_header
                        radius: 25
                        text: "Meet Info"
                        font_style: "H4"
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1  # White text color
                        md_bg_color: app.theme_cls.primary_color  # Use the primary color as the outline color
                        size_hint_y: None
                        halign: "center"
                        height: self.texture_size[1]  # Adjust the size based on text size

                    # meet info content
                    MDBoxLayout:
                        orientation: "vertical"
                        spacing: dp(5)
                        size_hint_y: None

                        # meet days and times
                        MDBoxLayout:
                            orientation: "vertical"
                            id: game_group_days_and_times
                            height: self.minimum_height
                            #adaptive_height: True

                        # meet location
                        MDLabel:
                            id: game_group_meet_location
                            text: f"Location: {root.group_meeting_location}"
                            color: [.2, .2, .2, 1]
                            font_size: 24
                            size_hint_x: 1
                            size_hint_y: None
                            height: self.texture_size[1]
                            #text_size: self.width, None
                            halign: "left"

                        # meet board games
                        MDStackLayout:
                            id: game_group_board_games
                            orientation: 'lr-tb'
                            spacing: dp(5)
                            #padding: [15, 10, 0, 0]
                            halign: "left"


                # users attending
                MDBoxLayout:
                    id: game_group_users_container
                    orientation: "vertical"
                    padding: [20, 0, 20, 50]
                    size_hint: 1, None
                    height: self.minimum_height + dp(100)
                    radius: 25
                    md_bg_color: app.theme_cls.primary_color
                    spacing: dp(10)

                    # users attending header
                    MDLabel:
                        id: game_group_users_header
                        radius: 25
                        text: "Users Attending"
                        font_style: "H4"
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1  # White text color
                        md_bg_color: app.theme_cls.primary_color  # Use the primary color as the outline color
                        size_hint_y: None
                        halign: "center"
                        height: self.texture_size[1]  # Adjust the size based on text size

                    # users attending list
                    MDBoxLayout:
                        id: game_group_users_list
                        orientation: 'horizontal'
                        spacing: dp(5)


                # looking for players... label
                MDLabel:
                    id: game_group_max_players
                    text: ""
                    color: [.2, .2, .2, 1]
                    font_size: 24
                    size_hint_y: None
                    height: self.texture_size[1]
                    text_size: self.width, None
                    halign: "left"

                # action buttons
                MDBoxLayout:
                    id: game_group_action_button_container
                    orientation: "vertical"
                    size_hint_y: None
                    padding: 0

                    GameGroupActionButtonsEditAndPublish:
                        id: game_group_buttons_edit_and_publish
                        game_group_screen: root

                    GameGroupActionButtonsRequestToJoin:
                        id: game_group_buttons_request_to_join
                        game_group_screen: root

                    GameGroupActionButtonsEditOrDelete:
                        id: game_group_buttons_edit_or_delete
                        game_group_screen: root

                    GameGroupActionButtonsLeave
                        id: game_group_buttons_leave
                        game_group_screen: root



<SeparatorLine>:
    canvas:
        Color:
            rgb: 0.5, 0.5, 0.5, 1  # Set the color of the line (gray)
        Line:
            points: self.x, self.y, self.x + self.width, self.y

<GameGroupActionButtonsEditAndPublish>:
    orientation: "horizontal"
    size_hint_y: None
    padding: 0

    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'bottom'
        padding: [dp(5), 0, 0, dp(10)]

        MDFillRoundFlatIconButton:
            text: "Edit Details"
            icon: "pencil"
            on_release: app.change_screen("create_group_screen")

    AnchorLayout:
        anchor_x: 'right'
        anchor_y: 'bottom'
        padding: [0, 0, dp(5), dp(10)]

        MDFillRoundFlatIconButton:
            text: "Publish your Group!"
            icon: "publish"
            on_release: root.open_publish_warning_popup()

<GameGroupActionButtonsRequestToJoin>:
    orientation: "horizontal"
    size_hint_y: None
    padding: 0

    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        padding: [dp(5), 0, 0, dp(10)]

        MDFillRoundFlatIconButton:
            text: "Request To Join"
            on_release: root.request_to_join()


<GameGroupActionButtonsEditOrDelete>:
    orientation: "horizontal"
    size_hint_y: None
    padding: 0

    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'bottom'
        padding: [dp(5), 0, 0, dp(10)]

        MDFillRoundFlatIconButton:
            text: "Edit Details"
            icon: "pencil"
            on_release: app.change_screen("create_group_screen")

    AnchorLayout:
        anchor_x: 'right'
        anchor_y: 'bottom'
        padding: [0, 0, dp(5), dp(10)]

        MDFillRoundFlatIconButton:
            text: "Delete Group"
            icon: "delete"
            on_release: root.open_delete_group_popup()


<GameGroupActionButtonsLeave>:
    orientation: "horizontal"
    size_hint_y: None
    padding: 0

    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        padding: [dp(5), 0, 0, dp(10)]

        MDFillRoundFlatIconButton:
            text: "Leave Group"
            on_release: root.open_leave_group_popup()